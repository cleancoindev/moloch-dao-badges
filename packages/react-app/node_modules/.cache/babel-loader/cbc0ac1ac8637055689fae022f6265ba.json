{"ast":null,"code":"var Reader = require('pull-reader');\n\nvar Writer = require('pull-pushable');\n\nvar cat = require('pull-cat');\n\nvar pair = require('pull-pair');\n\nfunction once(cb) {\n  var called = 0;\n  return function (a, b, c) {\n    if (called++) return;\n    cb(a, b, c);\n  };\n}\n\nfunction isFunction(f) {\n  return 'function' === typeof f;\n}\n\nmodule.exports = function (opts, _cb) {\n  if (isFunction(opts)) _cb = opts, opts = {};\n  _cb = once(_cb || function noop() {});\n  var reader = Reader(opts && opts.timeout || 5e3);\n  var writer = Writer(function (err) {\n    if (err) _cb(err);\n  });\n  var p = pair();\n  return {\n    handshake: {\n      read: reader.read,\n      abort: function (err) {\n        writer.end(err);\n        reader.abort(err, function (err) {});\n\n        _cb(err);\n      },\n      write: writer.push,\n      rest: function () {\n        writer.end();\n        return {\n          source: reader.read(),\n          sink: p.sink\n        };\n      }\n    },\n    sink: reader,\n    source: cat([writer, p.source])\n  };\n};","map":{"version":3,"sources":["/home/dekan/Projects/raid-guild/dao-badges-web/node_modules/pull-handshake/index.js"],"names":["Reader","require","Writer","cat","pair","once","cb","called","a","b","c","isFunction","f","module","exports","opts","_cb","noop","reader","timeout","writer","err","p","handshake","read","abort","end","write","push","rest","source","sink"],"mappings":"AAAA,IAAIA,MAAM,GAAGC,OAAO,CAAC,aAAD,CAApB;;AACA,IAAIC,MAAM,GAAGD,OAAO,CAAC,eAAD,CAApB;;AACA,IAAIE,GAAG,GAAGF,OAAO,CAAC,UAAD,CAAjB;;AACA,IAAIG,IAAI,GAAGH,OAAO,CAAC,WAAD,CAAlB;;AAEA,SAASI,IAAT,CAAeC,EAAf,EAAmB;AACjB,MAAIC,MAAM,GAAG,CAAb;AACA,SAAO,UAAUC,CAAV,EAAaC,CAAb,EAAgBC,CAAhB,EAAmB;AACxB,QAAGH,MAAM,EAAT,EAAa;AACbD,IAAAA,EAAE,CAACE,CAAD,EAAIC,CAAJ,EAAOC,CAAP,CAAF;AACD,GAHD;AAID;;AAED,SAASC,UAAT,CAAqBC,CAArB,EAAwB;AACtB,SAAO,eAAe,OAAOA,CAA7B;AACD;;AAEDC,MAAM,CAACC,OAAP,GAAiB,UAAUC,IAAV,EAAgBC,GAAhB,EAAqB;AACpC,MAAGL,UAAU,CAACI,IAAD,CAAb,EAAqBC,GAAG,GAAGD,IAAN,EAAYA,IAAI,GAAG,EAAnB;AACrBC,EAAAA,GAAG,GAAGX,IAAI,CAACW,GAAG,IAAI,SAASC,IAAT,GAAiB,CAAE,CAA3B,CAAV;AACA,MAAIC,MAAM,GAAGlB,MAAM,CAACe,IAAI,IAAIA,IAAI,CAACI,OAAb,IAAwB,GAAzB,CAAnB;AACA,MAAIC,MAAM,GAAGlB,MAAM,CAAC,UAAUmB,GAAV,EAAe;AACjC,QAAGA,GAAH,EAAQL,GAAG,CAACK,GAAD,CAAH;AACT,GAFkB,CAAnB;AAIA,MAAIC,CAAC,GAAGlB,IAAI,EAAZ;AAEA,SAAO;AACLmB,IAAAA,SAAS,EAAE;AACTC,MAAAA,IAAI,EAAEN,MAAM,CAACM,IADJ;AAETC,MAAAA,KAAK,EAAE,UAAUJ,GAAV,EAAe;AACpBD,QAAAA,MAAM,CAACM,GAAP,CAAWL,GAAX;AACAH,QAAAA,MAAM,CAACO,KAAP,CAAaJ,GAAb,EAAkB,UAAUA,GAAV,EAAe,CAChC,CADD;;AAEAL,QAAAA,GAAG,CAACK,GAAD,CAAH;AACD,OAPQ;AAQTM,MAAAA,KAAK,EAAEP,MAAM,CAACQ,IARL;AASTC,MAAAA,IAAI,EAAE,YAAY;AAChBT,QAAAA,MAAM,CAACM,GAAP;AACA,eAAO;AACLI,UAAAA,MAAM,EAAEZ,MAAM,CAACM,IAAP,EADH;AAELO,UAAAA,IAAI,EAAET,CAAC,CAACS;AAFH,SAAP;AAID;AAfQ,KADN;AAkBLA,IAAAA,IAAI,EAAEb,MAlBD;AAmBLY,IAAAA,MAAM,EAAE3B,GAAG,CAAC,CAACiB,MAAD,EAASE,CAAC,CAACQ,MAAX,CAAD;AAnBN,GAAP;AAqBD,CA/BD","sourcesContent":["var Reader = require('pull-reader')\nvar Writer = require('pull-pushable')\nvar cat = require('pull-cat')\nvar pair = require('pull-pair')\n\nfunction once (cb) {\n  var called = 0\n  return function (a, b, c) {\n    if(called++) return\n    cb(a, b, c)\n  }\n}\n\nfunction isFunction (f) {\n  return 'function' === typeof f\n}\n\nmodule.exports = function (opts, _cb) {\n  if(isFunction(opts)) _cb = opts, opts = {}\n  _cb = once(_cb || function noop () {})\n  var reader = Reader(opts && opts.timeout || 5e3)\n  var writer = Writer(function (err) {\n    if(err) _cb(err)\n  })\n\n  var p = pair()\n\n  return {\n    handshake: {\n      read: reader.read,\n      abort: function (err) {\n        writer.end(err)\n        reader.abort(err, function (err) {\n        })\n        _cb(err)\n      },\n      write: writer.push,\n      rest: function () {\n        writer.end()\n        return {\n          source: reader.read(),\n          sink: p.sink\n        }\n      }\n    },\n    sink: reader,\n    source: cat([writer, p.source])\n  }\n}\n"]},"metadata":{},"sourceType":"script"}