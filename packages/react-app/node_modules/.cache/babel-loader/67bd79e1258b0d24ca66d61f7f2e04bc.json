{"ast":null,"code":"'use strict';\n\nconst Datastore = require('datastore-fs');\n\nconst log = require('debug')('repo-migrations:repo:init');\n\nconst Key = require('interface-datastore').Key;\n\nconst versionKey = new Key('/version');\nconst configKey = new Key('/config');\n\nexports.isRepoInitialized = async function isRepoInitialized(path) {\n  let root;\n\n  try {\n    root = new Datastore(path, {\n      extension: '',\n      createIfMissing: false\n    });\n    const versionCheck = await root.has(versionKey);\n    const configCheck = await root.has(configKey);\n\n    if (!versionCheck || !configCheck) {\n      log(`Version entry present: ${versionCheck}`);\n      log(`Config entry present: ${configCheck}`);\n      return false;\n    }\n\n    return true;\n  } catch (e) {\n    log('While checking if repo is initialized error was thrown: ' + e.message);\n    return false;\n  } finally {\n    if (root !== undefined) await root.close();\n  }\n};","map":{"version":3,"sources":["/home/dekan/Projects/raid-guild/dao-badges-web/node_modules/ipfs-repo-migrations/src/repo/init.js"],"names":["Datastore","require","log","Key","versionKey","configKey","exports","isRepoInitialized","path","root","extension","createIfMissing","versionCheck","has","configCheck","e","message","undefined","close"],"mappings":"AAAA;;AAEA,MAAMA,SAAS,GAAGC,OAAO,CAAC,cAAD,CAAzB;;AACA,MAAMC,GAAG,GAAGD,OAAO,CAAC,OAAD,CAAP,CAAiB,2BAAjB,CAAZ;;AAEA,MAAME,GAAG,GAAGF,OAAO,CAAC,qBAAD,CAAP,CAA+BE,GAA3C;;AAEA,MAAMC,UAAU,GAAG,IAAID,GAAJ,CAAQ,UAAR,CAAnB;AACA,MAAME,SAAS,GAAG,IAAIF,GAAJ,CAAQ,SAAR,CAAlB;;AAEAG,OAAO,CAACC,iBAAR,GAA4B,eAAeA,iBAAf,CAAkCC,IAAlC,EAAwC;AAClE,MAAIC,IAAJ;;AACA,MAAI;AACFA,IAAAA,IAAI,GAAG,IAAIT,SAAJ,CAAcQ,IAAd,EAAoB;AAAEE,MAAAA,SAAS,EAAE,EAAb;AAAiBC,MAAAA,eAAe,EAAE;AAAlC,KAApB,CAAP;AAEA,UAAMC,YAAY,GAAG,MAAMH,IAAI,CAACI,GAAL,CAAST,UAAT,CAA3B;AACA,UAAMU,WAAW,GAAG,MAAML,IAAI,CAACI,GAAL,CAASR,SAAT,CAA1B;;AACA,QAAI,CAACO,YAAD,IAAiB,CAACE,WAAtB,EAAmC;AACjCZ,MAAAA,GAAG,CAAE,0BAAyBU,YAAa,EAAxC,CAAH;AACAV,MAAAA,GAAG,CAAE,yBAAwBY,WAAY,EAAtC,CAAH;AACA,aAAO,KAAP;AACD;;AAED,WAAO,IAAP;AACD,GAZD,CAYE,OAAOC,CAAP,EAAU;AACVb,IAAAA,GAAG,CAAC,6DAA6Da,CAAC,CAACC,OAAhE,CAAH;AACA,WAAO,KAAP;AACD,GAfD,SAeU;AACR,QAAIP,IAAI,KAAKQ,SAAb,EAAwB,MAAMR,IAAI,CAACS,KAAL,EAAN;AACzB;AACF,CApBD","sourcesContent":["'use strict'\n\nconst Datastore = require('datastore-fs')\nconst log = require('debug')('repo-migrations:repo:init')\n\nconst Key = require('interface-datastore').Key\n\nconst versionKey = new Key('/version')\nconst configKey = new Key('/config')\n\nexports.isRepoInitialized = async function isRepoInitialized (path) {\n  let root\n  try {\n    root = new Datastore(path, { extension: '', createIfMissing: false })\n\n    const versionCheck = await root.has(versionKey)\n    const configCheck = await root.has(configKey)\n    if (!versionCheck || !configCheck) {\n      log(`Version entry present: ${versionCheck}`)\n      log(`Config entry present: ${configCheck}`)\n      return false\n    }\n\n    return true\n  } catch (e) {\n    log('While checking if repo is initialized error was thrown: ' + e.message)\n    return false\n  } finally {\n    if (root !== undefined) await root.close()\n  }\n}\n"]},"metadata":{},"sourceType":"script"}