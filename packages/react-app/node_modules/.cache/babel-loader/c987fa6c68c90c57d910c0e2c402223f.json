{"ast":null,"code":"'use strict';\n\nconst cloneDeep = require('lodash.clonedeep');\n\nconst debug = require('debug')('hyperdiff');\n\nconst pullAt = require('lodash.pullat');\n\nconst isPresent = itemIndex => itemIndex !== -1;\n\nfunction GET_INITIAL_STATE() {\n  return {\n    common: [],\n    removed: []\n  };\n}\n\nfunction hasItemWithProps(collection, item, props) {\n  return props.every(prop => item[prop] === collection[prop]);\n}\n\nfunction indexOf(collection, item) {\n  return collection.indexOf(item);\n}\n\nfunction findIndexWithProps(collection, item, props) {\n  return collection.findIndex(function (origItem) {\n    return hasItemWithProps(origItem, item, props);\n  });\n}\n\nfunction determinateCollections(orig, dist) {\n  return {\n    first: orig,\n    second: cloneDeep(dist)\n  };\n}\n\nfunction determinateFindIndex(ids, props) {\n  return props ? findIndexWithProps : indexOf;\n}\n\nfunction hyperdiff(orig, dist, props) {\n  const ids = props ? [].concat(props) : [];\n  const {\n    first,\n    second\n  } = determinateCollections(orig, dist);\n  const findIndex = determinateFindIndex(ids, props);\n  debug('preconditions first=%j second=%j findIndex=%s', first, second, findIndex.name);\n  const results = first.reduce(function (acc, item, index) {\n    const itemIndex = findIndex(second, item, ids);\n    const destination = isPresent(itemIndex) ? 'common' : 'removed';\n    acc[destination].push(item);\n    pullAt(second, itemIndex);\n    debug('index=%s value=%s collection=%s', index, item, destination);\n    return acc;\n  }, GET_INITIAL_STATE());\n  results.added = second;\n  debug('added=%j removed=%j common%j', results.added, results.removed, results.common);\n  return results;\n}\n\nmodule.exports = hyperdiff;","map":{"version":3,"sources":["/home/samkuhlmann/Documents/ody/moloch/moloch-dao-badges/node_modules/hyperdiff/lib/index.js"],"names":["cloneDeep","require","debug","pullAt","isPresent","itemIndex","GET_INITIAL_STATE","common","removed","hasItemWithProps","collection","item","props","every","prop","indexOf","findIndexWithProps","findIndex","origItem","determinateCollections","orig","dist","first","second","determinateFindIndex","ids","hyperdiff","concat","name","results","reduce","acc","index","destination","push","added","module","exports"],"mappings":"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","sourcesContent":["'use strict'\n\nconst cloneDeep = require('lodash.clonedeep')\nconst debug = require('debug')('hyperdiff')\nconst pullAt = require('lodash.pullat')\n\nconst isPresent = (itemIndex) => itemIndex !== -1\n\nfunction GET_INITIAL_STATE () {\n  return { common: [], removed: [] }\n}\n\nfunction hasItemWithProps (collection, item, props) {\n  return props.every(prop => item[prop] === collection[prop])\n}\n\nfunction indexOf (collection, item) {\n  return collection.indexOf(item)\n}\n\nfunction findIndexWithProps (collection, item, props) {\n  return collection.findIndex(function (origItem) {\n    return hasItemWithProps(origItem, item, props)\n  })\n}\n\nfunction determinateCollections (orig, dist) {\n  return {first: orig, second: cloneDeep(dist)}\n}\n\nfunction determinateFindIndex (ids, props) {\n  return props ? findIndexWithProps : indexOf\n}\n\nfunction hyperdiff (orig, dist, props) {\n  const ids = props ? [].concat(props) : []\n  const {first, second} = determinateCollections(orig, dist)\n  const findIndex = determinateFindIndex(ids, props)\n\n  debug('preconditions first=%j second=%j findIndex=%s', first, second, findIndex.name)\n\n  const results = first.reduce(function (acc, item, index) {\n    const itemIndex = findIndex(second, item, ids)\n    const destination = isPresent(itemIndex) ? 'common' : 'removed'\n    acc[destination].push(item)\n    pullAt(second, itemIndex)\n    debug('index=%s value=%s collection=%s', index, item, destination)\n    return acc\n  }, GET_INITIAL_STATE())\n\n  results.added = second\n  debug('added=%j removed=%j common%j', results.added, results.removed, results.common)\n  return results\n}\n\nmodule.exports = hyperdiff\n"]},"metadata":{},"sourceType":"script"}