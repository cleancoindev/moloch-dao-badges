{"ast":null,"code":"'use strict';\n\nconst debug = require('debug');\n\nconst waterfall = require('async/waterfall');\n\nconst support = require('../support');\n\nconst crypto = require('./crypto');\n\nconst log = debug('libp2p:secio');\nlog.error = debug('libp2p:secio:error'); // step 2. Exchange\n// -- exchange (signed) ephemeral keys. verify signatures.\n\nmodule.exports = function exchange(state, callback) {\n  log('2. exchange - start');\n  log('2. exchange - writing exchange');\n  waterfall([cb => crypto.createExchange(state, cb), (ex, cb) => {\n    support.write(state, ex);\n    support.read(state.shake, cb);\n  }, (msg, cb) => {\n    log('2. exchange - reading exchange');\n    crypto.verify(state, msg, cb);\n  }, cb => crypto.generateKeys(state, cb)], err => {\n    if (err) {\n      return callback(err);\n    }\n\n    log('2. exchange - finish');\n    callback();\n  });\n};","map":{"version":3,"sources":["/home/samkuhlmann/Documents/ody/moloch/moloch-dao-badges/node_modules/libp2p-secio/src/handshake/exchange.js"],"names":["debug","require","waterfall","support","crypto","log","error","module","exports","exchange","state","callback","cb","createExchange","ex","write","read","shake","msg","verify","generateKeys","err"],"mappings":"AAAA;;AAEA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAC,iBAAD,CAAzB;;AAEA,MAAME,OAAO,GAAGF,OAAO,CAAC,YAAD,CAAvB;;AACA,MAAMG,MAAM,GAAGH,OAAO,CAAC,UAAD,CAAtB;;AAEA,MAAMI,GAAG,GAAGL,KAAK,CAAC,cAAD,CAAjB;AACAK,GAAG,CAACC,KAAJ,GAAYN,KAAK,CAAC,oBAAD,CAAjB,C,CAEA;AACA;;AACAO,MAAM,CAACC,OAAP,GAAiB,SAASC,QAAT,CAAmBC,KAAnB,EAA0BC,QAA1B,EAAoC;AACnDN,EAAAA,GAAG,CAAC,qBAAD,CAAH;AAEAA,EAAAA,GAAG,CAAC,gCAAD,CAAH;AACAH,EAAAA,SAAS,CAAC,CACPU,EAAD,IAAQR,MAAM,CAACS,cAAP,CAAsBH,KAAtB,EAA6BE,EAA7B,CADA,EAER,CAACE,EAAD,EAAKF,EAAL,KAAY;AACVT,IAAAA,OAAO,CAACY,KAAR,CAAcL,KAAd,EAAqBI,EAArB;AACAX,IAAAA,OAAO,CAACa,IAAR,CAAaN,KAAK,CAACO,KAAnB,EAA0BL,EAA1B;AACD,GALO,EAMR,CAACM,GAAD,EAAMN,EAAN,KAAa;AACXP,IAAAA,GAAG,CAAC,gCAAD,CAAH;AACAD,IAAAA,MAAM,CAACe,MAAP,CAAcT,KAAd,EAAqBQ,GAArB,EAA0BN,EAA1B;AACD,GATO,EAUPA,EAAD,IAAQR,MAAM,CAACgB,YAAP,CAAoBV,KAApB,EAA2BE,EAA3B,CAVA,CAAD,EAWLS,GAAD,IAAS;AACV,QAAIA,GAAJ,EAAS;AAAE,aAAOV,QAAQ,CAACU,GAAD,CAAf;AAAsB;;AAEjChB,IAAAA,GAAG,CAAC,sBAAD,CAAH;AACAM,IAAAA,QAAQ;AACT,GAhBQ,CAAT;AAiBD,CArBD","sourcesContent":["'use strict'\n\nconst debug = require('debug')\nconst waterfall = require('async/waterfall')\n\nconst support = require('../support')\nconst crypto = require('./crypto')\n\nconst log = debug('libp2p:secio')\nlog.error = debug('libp2p:secio:error')\n\n// step 2. Exchange\n// -- exchange (signed) ephemeral keys. verify signatures.\nmodule.exports = function exchange (state, callback) {\n  log('2. exchange - start')\n\n  log('2. exchange - writing exchange')\n  waterfall([\n    (cb) => crypto.createExchange(state, cb),\n    (ex, cb) => {\n      support.write(state, ex)\n      support.read(state.shake, cb)\n    },\n    (msg, cb) => {\n      log('2. exchange - reading exchange')\n      crypto.verify(state, msg, cb)\n    },\n    (cb) => crypto.generateKeys(state, cb)\n  ], (err) => {\n    if (err) { return callback(err) }\n\n    log('2. exchange - finish')\n    callback()\n  })\n}\n"]},"metadata":{},"sourceType":"script"}