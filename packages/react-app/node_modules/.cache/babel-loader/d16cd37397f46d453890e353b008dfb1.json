{"ast":null,"code":"'use strict';\n\nclass DocumentIndex {\n  constructor() {\n    this._index = {};\n  }\n\n  get(key, fullOp = false) {\n    return fullOp ? this._index[key] : this._index[key] ? this._index[key].payload.value : null;\n  }\n\n  updateIndex(oplog, onProgressCallback) {\n    const reducer = (handled, item, idx) => {\n      if (handled[item.payload.key] !== true) {\n        handled[item.payload.key] = true;\n\n        if (item.payload.op === 'PUT') {\n          this._index[item.payload.key] = item;\n        } else if (item.payload.op === 'DEL') {\n          delete this._index[item.payload.key];\n        }\n      }\n\n      if (onProgressCallback) onProgressCallback(item, idx);\n      return handled;\n    };\n\n    oplog.values.slice().reverse().reduce(reducer, {});\n  }\n\n}\n\nmodule.exports = DocumentIndex;","map":{"version":3,"sources":["/home/samkuhlmann/Documents/ody/moloch/moloch-dao-badges/node_modules/orbit-db-docstore/src/DocumentIndex.js"],"names":["DocumentIndex","constructor","_index","get","key","fullOp","payload","value","updateIndex","oplog","onProgressCallback","reducer","handled","item","idx","op","values","slice","reverse","reduce","module","exports"],"mappings":"AAAA;;AAEA,MAAMA,aAAN,CAAoB;AAClBC,EAAAA,WAAW,GAAI;AACb,SAAKC,MAAL,GAAc,EAAd;AACD;;AAEDC,EAAAA,GAAG,CAAEC,GAAF,EAAOC,MAAM,GAAG,KAAhB,EAAuB;AACxB,WAAOA,MAAM,GACT,KAAKH,MAAL,CAAYE,GAAZ,CADS,GAET,KAAKF,MAAL,CAAYE,GAAZ,IAAmB,KAAKF,MAAL,CAAYE,GAAZ,EAAiBE,OAAjB,CAAyBC,KAA5C,GAAoD,IAFxD;AAGD;;AAEDC,EAAAA,WAAW,CAAEC,KAAF,EAASC,kBAAT,EAA6B;AACtC,UAAMC,OAAO,GAAG,CAACC,OAAD,EAAUC,IAAV,EAAgBC,GAAhB,KAAwB;AACtC,UAAIF,OAAO,CAACC,IAAI,CAACP,OAAL,CAAaF,GAAd,CAAP,KAA8B,IAAlC,EAAwC;AACtCQ,QAAAA,OAAO,CAACC,IAAI,CAACP,OAAL,CAAaF,GAAd,CAAP,GAA4B,IAA5B;;AACA,YAAGS,IAAI,CAACP,OAAL,CAAaS,EAAb,KAAoB,KAAvB,EAA8B;AAC5B,eAAKb,MAAL,CAAYW,IAAI,CAACP,OAAL,CAAaF,GAAzB,IAAgCS,IAAhC;AACD,SAFD,MAEO,IAAIA,IAAI,CAACP,OAAL,CAAaS,EAAb,KAAoB,KAAxB,EAA+B;AACpC,iBAAO,KAAKb,MAAL,CAAYW,IAAI,CAACP,OAAL,CAAaF,GAAzB,CAAP;AACD;AACF;;AACD,UAAIM,kBAAJ,EAAwBA,kBAAkB,CAACG,IAAD,EAAOC,GAAP,CAAlB;AACxB,aAAOF,OAAP;AACD,KAXD;;AAaAH,IAAAA,KAAK,CAACO,MAAN,CACGC,KADH,GAEGC,OAFH,GAGGC,MAHH,CAGUR,OAHV,EAGmB,EAHnB;AAID;;AA7BiB;;AAgCpBS,MAAM,CAACC,OAAP,GAAiBrB,aAAjB","sourcesContent":["'use strict'\n\nclass DocumentIndex {\n  constructor () {\n    this._index = {}\n  }\n\n  get (key, fullOp = false) {\n    return fullOp\n      ? this._index[key]\n      : this._index[key] ? this._index[key].payload.value : null\n  }\n\n  updateIndex (oplog, onProgressCallback) {\n    const reducer = (handled, item, idx) => {\n      if (handled[item.payload.key] !== true) {\n        handled[item.payload.key] = true\n        if(item.payload.op === 'PUT') {\n          this._index[item.payload.key] = item\n        } else if (item.payload.op === 'DEL') {\n          delete this._index[item.payload.key]\n        }\n      }\n      if (onProgressCallback) onProgressCallback(item, idx)\n      return handled\n    }\n\n    oplog.values\n      .slice()\n      .reverse()\n      .reduce(reducer, {})\n  }\n}\n\nmodule.exports = DocumentIndex\n"]},"metadata":{},"sourceType":"script"}